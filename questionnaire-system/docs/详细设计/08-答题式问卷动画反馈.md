答题式问卷动画反馈
1、简要描述
（1）功能描述：答题式问卷在用户作答后点击下一题时，验证答案后，提供即时的视觉反馈动画。根据答案的正确性，系统会展示不同的动画效果，以增强用户体验。

（2）代码逻辑：
用户在答题模式问卷中选择答案后点击"下一题"按钮，系统调用 checkQuizAnswer函数检查答案是否正确。该函数从题目对象中获取correctAnswer字段，与用户答案进行比较：单选题直接比较答案ID，多选题将两个数组排序后比较JSON字符串。系统根据比较结果设置 feedbackType（'correct' 或 'incorrect'），并显示QuizFeedbackEnhanced组件。正确答案动画包含四个层次：背景粒子效果（20 个彩色粒子从中心向外扩散，每个粒子随机颜色和距离，动画时长1.2s），光环扩散效果（3个同心圆从中心向外脉冲扩散，延迟0.3s/0.6s，透明度从0到0.5再到0），奖杯旋转动画（奖杯从缩放0和旋转-180deg弹出，使用弹性缓动函数），烟花星星特效（3组烟花在页面上方爆发，每组8个火花向外射出，星星装饰散布在周围并闪烁）。错误答案动画包含四个层次：波纹扩散效果（3个同心圆从中心向外扩散，宽度从 100px到400px，延迟0.15s 递增），思考表情动画（黄色圆脸从缩放0弹出，眼睛每3s眨眼一次，瞳孔左右移动，嘴巴上下移动），问号气泡浮动（3个白色圆形气泡从思考表情右上角浮起，大小递减，延迟递增），漂浮问号渐隐（6个问号从不同位置向上漂浮并逐渐透明，每个延迟0.15s）。动画播放2秒后自动关闭反馈弹窗，系统调用proceedToNextQuestion函数跳转到下一题或提交问卷。

###答题式问卷动画反馈时序图描述
用户 → AnswerPage.vue: 选择答案后点击"下一题"
AnswerPage.vue → AnswerPage.vue: 验证必答题是否已作答
AnswerPage.vue → AnswerPage.vue: 提交当前答案（commitAnswer）
AnswerPage.vue → quiz.js: 调用 checkQuizAnswer 检查答案
quiz.js → quiz.js: 获取题目 correctAnswer 字段
quiz.js → quiz.js: 比较用户答案与正确答案（单选/多选）
quiz.js → AnswerPage.vue: 返回比较结果（true/false/null）
AnswerPage.vue → AnswerPage.vue: 设置 feedbackType（correct/incorrect）
AnswerPage.vue → QuizFeedbackEnhanced.vue: 显示反馈动画（showFeedback=true）
QuizFeedbackEnhanced.vue → QuizFeedbackEnhanced.vue: 渲染对应动画（正确/错误）
QuizFeedbackEnhanced.vue → 用户界面: 展示粒子/光环/奖杯/烟花（正确）
QuizFeedbackEnhanced.vue → 用户界面: 展示波纹/表情/气泡/问号（错误）
QuizFeedbackEnhanced.vue → QuizFeedbackEnhanced.vue: 2秒后触发 finish 事件
QuizFeedbackEnhanced.vue → AnswerPage.vue: 调用 handleFeedbackFinish
AnswerPage.vue → AnswerPage.vue: 关闭反馈弹窗（showFeedback=false）
AnswerPage.vue → AnswerPage.vue: 调用 proceedToNextQuestion 跳转下一题

***最新时序图描述***
用户 → AnswerPage.vue: 点击"下一题"
AnswerPage.vue → AnswerPage.vue: 验证必答题并提交当前答案
AnswerPage.vue → quiz.js: 检查答案正确性
quiz.js → AnswerPage.vue: 返回答案检查结果
AnswerPage.vue → AnswerPage.vue: 设置反馈类型（正确/错误）
AnswerPage.vue → QuizFeedbackEnhanced.vue: 显示反馈动画
QuizFeedbackEnhanced.vue → 用户界面: 展示相应动画效果（正确→粒子/烟花，错误→波纹/问号）
QuizFeedbackEnhanced.vue → QuizFeedbackEnhanced.vue: 2秒后自动结束
QuizFeedbackEnhanced.vue → AnswerPage.vue: 触发反馈完成事件
AnswerPage.vue → AnswerPage.vue: 关闭反馈弹窗
AnswerPage.vue → AnswerPage.vue: 跳转到下一题
***end***

***时序图最新描述***
    用户->>前端AnswerPage.vue: ① 选择答案后点击"下一题"
    前端AnswerPage.vue->>前端AnswerPage.vue: ② 验证必答题并提交当前答案
    前端AnswerPage.vue->>quiz.js: ③ 检查答案正确性
    quiz.js-->>前端AnswerPage.vue: ④ 返回答案检查结果(true/false/null)
    前端AnswerPage.vue->>前端AnswerPage.vue: ⑤ 设置反馈类型(correct/incorrect)
    前端AnswerPage.vue->>动画组件(QuizFeedbackEnhanced.vue): ⑥ 显示反馈动画
    动画组件(QuizFeedbackEnhanced.vue)->>用户界面: ⑦ 展示相应动画效果(正确→粒子/烟花，错误→波纹/问号)
    动画组件(QuizFeedbackEnhanced.vue)->>动画组件(QuizFeedbackEnhanced.vue): ⑧ 2秒后自动结束
    动画组件(QuizFeedbackEnhanced.vue)-->>前端AnswerPage.vue: ⑨ 触发反馈完成事件
    前端AnswerPage.vue->>前端AnswerPage.vue: ⑩ 关闭反馈弹窗并跳转下一题
***end***

2、接口定义
表 5-8 答题式问卷动画反馈接口表
说明：答题反馈功能在前端实现，不需要独立的后端接口。答案检查逻辑基于问卷数据中的 correctAnswer 字段（通过 /surveys/:id 接口获取）进行本地计算。

3、关键代码
代码 5-8 答题式问卷动画反馈核心实现代码

// 答案检查逻辑（quiz.js）
export function checkQuizAnswer(question, answer) {
  if (!question.quizMode || !question.correctAnswer) {
    return null;
  }
  
  if (question.type === "single") {
    return answer === question.correctAnswer;
  }
  
  if (question.type === "multiple") {
    return JSON.stringify([...answer].sort()) === 
           JSON.stringify([...question.correctAnswer].sort());
  }
  
  return null;
}

// 粒子爆发动画（QuizFeedbackEnhanced.vue）
@keyframes particle-burst {
  0% {
    transform: translate(-50%, -50%) rotate(var(--angle)) translateY(0) scale(0);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) rotate(var(--angle))
      translateY(var(--distance)) scale(1);
    opacity: 0;
  }
}

// 光环扩散动画（QuizFeedbackEnhanced.vue）
@keyframes ring-pulse {
  0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
  50% { opacity: 0.5; }
  100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0; }
}

// 奖杯弹出动画（QuizFeedbackEnhanced.vue）
@keyframes trophy-pop {
  0% { transform: scale(0) rotate(-180deg); opacity: 0; }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

// 波纹扩散动画（QuizFeedbackEnhanced.vue）
@keyframes ripple-expand {
  0% { width: 100px; height: 100px; opacity: 1; }
  100% { width: 400px; height: 400px; opacity: 0; }
}

// 思考表情眨眼动画（QuizFeedbackEnhanced.vue）
@keyframes blink {
  0%, 96%, 100% { transform: scaleY(1); }
  98% { transform: scaleY(0.1); }
}
