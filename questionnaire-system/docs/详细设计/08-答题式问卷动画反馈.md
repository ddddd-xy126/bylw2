答题式问卷动画反馈
1、简要描述
（1）功能描述：答题式问卷在用户作答后提供即时的视觉反馈动画，通过丰富的动画效果帮助用户了解答题结果。正确答案触发正向激励动画（彩色粒子爆发、光环扩散、奖杯旋转、烟花星星特效），错误答案触发引导性动画（思考表情、问号气泡浮动、波纹扩散、漂浮问号渐隐）。

（2）代码逻辑：
用户在答题模式问卷中选择答案后点击"下一题"按钮，系统调用 checkQuizAnswer 函数检查答案是否正确。该函数从题目对象中获取 correctAnswer 字段，与用户答案进行比较：单选题直接比较答案 ID，多选题将两个数组排序后比较 JSON 字符串。系统根据比较结果设置 feedbackType（'correct' 或 'incorrect'），并显示 QuizFeedbackEnhanced 组件。正确答案动画包含四个层次：背景粒子效果（20 个彩色粒子从中心向外扩散，每个粒子随机颜色和距离，动画时长 1.2s），光环扩散效果（3 个同心圆从中心向外脉冲扩散，延迟 0.3s、0.6s，透明度从 0 到 0.5 再到 0），奖杯旋转动画（奖杯从缩放 0 和旋转 -180deg 弹出，使用弹性缓动函数），烟花星星特效（3 组烟花在页面上方爆发，每组 8 个火花向外射出，星星装饰散布在周围并闪烁）。错误答案动画包含四个层次：波纹扩散效果（3 个同心圆从中心向外扩散，宽度从 100px 到 400px，延迟 0.15s 递增），思考表情动画（黄色圆脸从缩放 0 弹出，眼睛每 3s 眨眼一次，瞳孔左右移动，嘴巴上下移动），问号气泡浮动（3 个白色圆形气泡从思考表情右上角浮起，大小递减，延迟递增），漂浮问号渐隐（6 个问号从不同位置向上漂浮并逐渐透明，每个延迟 0.15s）。动画播放 2 秒后自动关闭反馈弹窗，系统调用 proceedToNextQuestion 函数跳转到下一题或提交问卷。

###答题式问卷动画反馈时序图描述
用户 → AnswerPage.vue: 选择答案后点击"下一题"
AnswerPage.vue → AnswerPage.vue: 验证必答题是否已作答
AnswerPage.vue → AnswerPage.vue: 提交当前答案（commitAnswer）
AnswerPage.vue → quiz.js: 调用 checkQuizAnswer 检查答案
quiz.js → quiz.js: 获取题目 correctAnswer 字段
quiz.js → quiz.js: 比较用户答案与正确答案（单选/多选）
quiz.js → AnswerPage.vue: 返回比较结果（true/false/null）
AnswerPage.vue → AnswerPage.vue: 设置 feedbackType（correct/incorrect）
AnswerPage.vue → QuizFeedbackEnhanced.vue: 显示反馈动画（showFeedback=true）
QuizFeedbackEnhanced.vue → QuizFeedbackEnhanced.vue: 渲染对应动画（正确/错误）
QuizFeedbackEnhanced.vue → 用户界面: 展示粒子/光环/奖杯/烟花（正确）
QuizFeedbackEnhanced.vue → 用户界面: 展示波纹/表情/气泡/问号（错误）
QuizFeedbackEnhanced.vue → QuizFeedbackEnhanced.vue: 2秒后触发 finish 事件
QuizFeedbackEnhanced.vue → AnswerPage.vue: 调用 handleFeedbackFinish
AnswerPage.vue → AnswerPage.vue: 关闭反馈弹窗（showFeedback=false）
AnswerPage.vue → AnswerPage.vue: 调用 proceedToNextQuestion 跳转下一题

2、接口定义
表 5-8 答题式问卷动画反馈接口表
说明：答题反馈功能在前端实现，不需要独立的后端接口。答案检查逻辑基于问卷数据中的 correctAnswer 字段（通过 /surveys/:id 接口获取）进行本地计算。

3、关键代码
代码 5-8 答题式问卷动画反馈核心实现代码

// 检查答案是否正确（quiz.js）
export function checkQuizAnswer(question, answer) {
  if (!question.quizMode || !question.correctAnswer) {
    return null; // 非答题模式
  }

  const correct = question.correctAnswer;

  if (question.type === "single") {
    // 单选：直接比较
    return answer === correct;
  }

  if (question.type === "multiple") {
    // 多选：数组排序后比较
    if (!Array.isArray(answer) || !Array.isArray(correct)) {
      return false;
    }
    return (
      JSON.stringify([...answer].sort()) === JSON.stringify([...correct].sort())
    );
  }

  return null;
}

// 粒子爆发动画（QuizFeedbackEnhanced.vue）
.particle {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 8px;
  height: 8px;
  background: var(--color);
  border-radius: 50%;
  animation: particle-burst 1.2s ease-out forwards;
}

@keyframes particle-burst {
  0% {
    transform: translate(-50%, -50%) rotate(var(--angle)) translateY(0) scale(0);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) rotate(var(--angle))
      translateY(var(--distance)) scale(1);
    opacity: 0;
  }
}

// 光环扩散动画（QuizFeedbackEnhanced.vue）
.ring {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  animation: ring-pulse 1.5s ease-out infinite;
}

@keyframes ring-pulse {
  0% {
    transform: translate(-50%, -50%) scale(0.8);
    opacity: 0;
  }
  50% {
    opacity: 0.5;
  }
  100% {
    transform: translate(-50%, -50%) scale(1.2);
    opacity: 0;
  }
}

// 奖杯旋转动画（QuizFeedbackEnhanced.vue）
.trophy-container {
  position: relative;
  animation: trophy-pop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes trophy-pop {
  0% {
    transform: scale(0) rotate(-180deg);
    opacity: 0;
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

// 烟花特效（QuizFeedbackEnhanced.vue）
.spark {
  position: absolute;
  width: 3px;
  height: 20px;
  background: linear-gradient(to bottom, rgba(255, 255, 255, 1), rgba(255, 215, 0, 0));
  animation: spark-shoot 0.8s ease-out forwards;
}

@keyframes spark-shoot {
  0% {
    transform: rotate(var(--rotation)) translateY(0) scaleY(0);
    opacity: 1;
  }
  100% {
    transform: rotate(var(--rotation)) translateY(-50px) scaleY(1);
    opacity: 0;
  }
}

// 波纹扩散动画（QuizFeedbackEnhanced.vue）
.ripple {
  position: absolute;
  border: 3px solid rgba(255, 255, 255, 0.4);
  border-radius: 50%;
  animation: ripple-expand 2s ease-out infinite;
}

@keyframes ripple-expand {
  0% {
    width: 100px;
    height: 100px;
    opacity: 1;
  }
  100% {
    width: 400px;
    height: 400px;
    opacity: 0;
  }
}

// 思考表情动画（QuizFeedbackEnhanced.vue）
.thinking-face {
  animation: face-pop 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.eye {
  animation: blink 3s infinite;
}

@keyframes blink {
  0%, 96%, 100% { transform: scaleY(1); }
  98% { transform: scaleY(0.1); }
}

.pupil {
  animation: pupil-move 4s ease-in-out infinite;
}

@keyframes pupil-move {
  0%, 100% { transform: translate(-50%, -50%); }
  25% { transform: translate(-30%, -50%); }
  75% { transform: translate(-70%, -50%); }
}

// 问号气泡浮动（QuizFeedbackEnhanced.vue）
.bubble {
  animation: bubble-float 2s ease-in-out infinite;
}

@keyframes bubble-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

// 漂浮问号渐隐（QuizFeedbackEnhanced.vue）
.question-mark {
  animation: float-fade 3s ease-out forwards;
}

@keyframes float-fade {
  0% {
    transform: translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateY(-100px);
    opacity: 0;
  }
}
