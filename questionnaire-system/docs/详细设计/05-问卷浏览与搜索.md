问卷浏览与搜索
1、简要描述
（1）功能描述:用户可以在问卷列表页面浏览所有已发布的问卷，并通过搜索框和分类按钮进行筛选。

（2）代码逻辑:
用户进入问卷列表页面，组件在生命周期钩子中加载问卷列表和分类数据。系统通过调用listSurvey接口获取所有已发布且正在收集的问卷，通过getCategoriesApi 接口获取所有分类信息，将数据存储到Pinia store中。页面渲染时，从store读取问卷列表，过滤出状态为 published且isCollecting不为false的问卷进行展示。用户可以在搜索框中输入关键词，系统会实时过滤问卷标题、描述和标签中包含该关键词的问卷。用户也可以点击分类按钮，系统根据所选分类的categoryId过滤问卷列表。

###问卷浏览与搜索时序图描述
用户 → List.vue: 进入问卷列表页面（/surveys路由）
List.vue → loadData: onMounted钩子调用loadData函数
loadData → 后端API: 并发请求问卷列表（GET /surveys）和分类列表（GET /categories）
后端API → MySQL: 查询surveys表（status=published, isCollecting=true）
MySQL → 后端API: 返回问卷数据
后端API → 后端API: 调用getCategories方法
后端API → MySQL: 查询categories表
MySQL → 后端API: 返回分类数据
后端API → loadData: 返回问卷和分类数据
loadData → Pinia store: 存储问卷和分类数据
List.vue → Pinia store: 读取问卷和分类数据
List.vue → 用户界面: 渲染问卷列表（仅显示published且isCollecting≠false的问卷）

用户 → List.vue: 输入搜索关键词或点击分类按钮
List.vue → List.vue: 实时过滤问卷列表（关键词匹配标题/描述/标签，或按分类ID筛选）
List.vue → 用户界面: 更新展示的问卷列表

2、接口定义
表 5-5 问卷浏览与搜索接口表
接口名称       获取问卷列表接口
接口描述       获取所有已发布的问卷列表，支持按状态、分类、搜索关键词等筛选
URL           {{baseurl}}/surveys
method        GET
请求参数       status: 问卷状态（published），categoryId: 分类ID，search: 搜索关键词，page: 页码，limit: 每页数量
返回参数        [{"id": "1", "title": "问卷标题", "description": "问卷描述", "categoryId": "1", "status": "published", "participantCount": 100, "averageRating": 4.5, ...}, ...]

接口名称       获取分类列表接口
接口描述       获取所有问卷分类，用于分类筛选按钮展示
URL           {{baseurl}}/categories
method        GET
请求参数       无
返回参数        [{"id": "1", "name": "教育培训", "slug": "education", ...}, ...]

3、关键代码
代码 5-5 问卷浏览与搜索核心实现代码

// 加载问卷和分类数据（useHomeLogic.js）
const loadData = async () => {
  loading.value = true;
  try {
    // 并发请求问卷列表和分类列表
    const [surveysData, categoriesData] = await Promise.all([
      listSurveys(),
      getCategoriesApi(),
    ]);
    // 存储到 Pinia store
    dataStore.setSurveys(surveysData || []);
    dataStore.setCategories(categoriesData || []);
  } catch (error) {
    console.error("加载数据失败:", error);
    ElMessage.error("加载数据失败");
  } finally {
    loading.value = false;
  }
};

// 选择分类（List.vue）
const selectCategory = (catId) => {
  selectedCategory.value = catId;
  currentPage.value = 1; // 重置页码
  handleCategoryChange();
};

// 过滤和排序逻辑（List.vue）
const surveysToShow = computed(() => {
  const list = Array.isArray(surveys.value)
    ? surveys.value.filter(
        (s) => s.status === "published" && s.isCollecting !== false
      )
    : [];

  // 分类过滤
  let filtered = list;
  if (selectedCategory.value) {
    filtered = list.filter((s) => {
      const sid = getSurveyCategoryId(s);
      return sid ? sid === String(selectedCategory.value) : false;
    });
  }
  const result = [...filtered];
  return result;
});