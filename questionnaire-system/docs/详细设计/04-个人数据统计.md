个人数据统计
1、简要描述
（1）功能描述：个人数据统计功能展示用户在平台的活跃情况和数据概览，包括创建问卷数、参与问卷数、获得积分和收藏问卷四项核心指标。

（2）代码逻辑：
用户进入个人中心的个人信息页面后，组件在 onMounted 生命周期钩子中自动调用 loadUserStats 函数加载统计数据。系统首先从 Pinia store 中获取当前登录用户的基本信息，提取用户 ID 和积分信息。接着，系统通过后端 API 请求获取用户的详细统计数据：调用 /surveys 接口查询该用户创建的所有问卷，统计长度得到创建问卷数；调用 /answers 接口查询该用户提交的所有答案记录，统计长度得到参与问卷数；从 Pinia store 的 favorites 数组获取收藏数量；从 user.profile.points 字段获取当前积分。所有数据获取完成后，系统将统计结果更新到 userStats 响应式对象中，前端自动渲染到页面的统计卡片。

###个人数据统计时序图描述
用户 → InfoPage.vue: 访问个人信息页面
InfoPage.vue → loadUserStats: 加载用户统计数据
loadUserStats → Pinia store: 获取用户基本信息
Pinia store → loadUserStats: 返回用户信息和积分
loadUserStats → 后端 API: 并发请求用户问卷和答案数据
后端 API → MySQL: 查询用户相关数据
MySQL → 后端 API: 返回数据
后端 API → loadUserStats: 返回问卷和答案数据
loadUserStats → loadUserStats: 统计创建/参与问卷数
loadUserStats → Pinia store: 获取收藏数量
loadUserStats → loadUserStats: 组装统计对象
InfoPage.vue → 界面: 渲染统计卡片

2、接口定义
表 5-4 个人数据统计接口表
接口名称 查询用户问卷接口
接口描述 查询指定用户创建的问卷列表，用于统计创建问卷数
URL {{baseurl}}/surveys?userId={id}&limit=5000
method GET
请求参数 userId: 用户 ID, limit: 查询数量限制
返回参数 [{"id": "1", "title": "问卷 1", "userId": "123", ...}, ...]

接口名称 查询用户答题结果接口
接口描述 查询指定用户提交的答案记录列表，用于统计参与问卷数
URL {{baseurl}}/answers?userId={id}
method GET
请求参数 userId: 用户 ID
返回参数 [{"id": "1", "surveyId": "1", "userId": "123", "answers": [...], ...}, ...]

3、关键代码
代码 5-4 个人数据统计核心实现代码

// 加载用户统计数据（InfoPage.vue）
const loadUserStats = async () => {
try {
// 从用户 store 获取基本信息
const profile = userStore.profile;
if (!profile) {
console.warn("用户未登录");
return;
}

    // 获取积分（直接从 profile 中读取）
    userStats.totalPoints = profile.points || 0;

    // 获取收藏数量（从 store 的 favorites 数组）
    userStats.totalCollections = userStore.favorites?.length || 0;

    // 使用后端 API 获取该用户创建的问卷数量
    const userSurveys = await apiClient.get(
      `/surveys?userId=${profile.id}&limit=5000`
    );
    userStats.totalQuestionnaires = userSurveys?.length || 0;

    // 使用后端 API 获取该用户的答题数量（参与问卷）
    const userAnswers = await apiClient.get(`/answers?userId=${profile.id}`);
    userStats.totalAnswers = userAnswers?.length || 0;

    console.log("用户统计已加载:", userStats);

} catch (error) {
console.error("加载用户统计失败:", error);
}
};

// 生命周期钩子：页面加载时自动获取统计数据
onMounted(() => {
loadUserInfo(); // 加载用户基本信息
loadUserStats(); // 加载用户统计数据
loadTagOptions(); // 加载标签选项
});


***时序图最新描述***
    用户->>前端InfoPage.vue: ① 访问个人信息页面
    前端InfoPage.vue->>前端InfoPage.vue: ② onMounted调用loadUserStats
    前端InfoPage.vue->>Pinia(userStore): ③ 获取用户基本信息和积分
    Pinia(userStore)-->>前端InfoPage.vue: ④ 返回用户信息
    前端InfoPage.vue->>API层(apiClient): ⑤ 并发请求问卷和答题数据
    API层(apiClient)->>后端路由(surveys.js + answers.js): ⑥ GET /surveys?userId=xxx 和 GET /answers?userId=xxx
    后端路由(surveys.js + answers.js)->>数据库: ⑦ 查询用户问卷和答题记录
    数据库-->>后端路由(surveys.js + answers.js): ⑧ 返回查询结果
    后端路由(surveys.js + answers.js)-->>前端InfoPage.vue: ⑨ 返回问卷和答题数据
    前端InfoPage.vue->>前端InfoPage.vue: ⑩ 统计数量并更新userStats
    前端InfoPage.vue-->>用户: ⑪ 渲染统计卡片
***end***
